<!DOCTYPE html>
<html>
	<head>
		<title>Sarlack-Lab-C2-Tracking</title>
		<link rel="shortcut icon" type="image/x-icon" href="favicon.ico">
		<style>
			* {
				box-sizing:border-box;
			}
			body {
				font-family:Arial;
				padding:10px;
				background:#171717;
				color:#E8E8E8;
			}
			h1, h2, h3, h4 {
				color:#FFFF00;
			}
			a {
				font-weight:bold;
				color:#3A74E8;
			}
			a:visited {
				color:#B42DB4;
			}
			p {
				padding:10px;
			}
			.ind {
				margin: 0 auto;
				padding:10px;
			}
			.box {
				float:center;
				padding:10px;
				background:#2E2E2E;
			}
		</style>
	</head>
	<body>
		<h1>Sarlack-Lab Nanocore Hunting</h1>
		<p><i>Kicking ACKs and taking domain names</i></p>
		<br>
		<h2>Background</h2>
		<p>Nanocore is a popular Remote Access Trojan (RAT) which gives attackers control of
			 target computers. The RAT was written with .NET framework by Taylor Huddleston back
			 in 2013 (<a href="https://www.fbi.gov/news/stories/malware-creator-sentenced-070518">
			 arrested</a> in 2017). Despite its age, Nanocore remains popular among
			 cyber-criminals because of its ease-of-use and multiple plugins which assist
			 non-technical actors with stealing information and spying on victims. According to
			 ANY.RUN <a href="https://any.run/malware-trends/">Trends</a> Nanocore was the 8th
			 most common malware strain in June 2022, and remains the 7th most common overall.</p>
		<br>
		<h2>Functionality</h2><!--Needs to be re-named...-->
		<p>The NanoCore RAT has several spyware capabilites which, according to <a href="https://attack.mitre.org/software/S0336/#groups">research</a>
			 compiled by ATT&CK, have been used by advanced groups in high-profile espianoge
			 incidents. The RAT is primarily operated from a platform which functions as both a
			 builder and a command-and-control (C2) panel. There are multiple NanoCore
			 plugins which can be purchased (or stolen/cracked) from cyber-crime forums
			 - though NanoCore's base payload is already capable of:</p>
		<ul>
			<li>reading from/writing to an infected computer's file system</li>
			<li>executing programs</li>
			<li>stealing saved passwords</li>
			<li>logging keystrokes</li>
			<li>surveiling the webcam</li>
			<li>and poppin' a shell</li>
		</ul>
		 <p>Once deployed, single agents or an entire botnet can be controlled from the C2 panel.
			 At start-up, NanoCore will query the domain name of its assigned C2 server and then
			 attempt to use the answered IP address for all of its communications. By default,
			 NanoCore payloads are configured with 8.8.8.8 as their primary DNS server and
			 8.8.4.4 as a backup. Some payloads are also configured with primary and secondary C2
			 domains - though many threat actors just list the same domain/IP twice.</p>
		<p>NanoCome payloads communicate to their C2 servers over TCP using a custom encrypted
			 protocol. The protocol encrypts using DES (curiously  and IV are the same). . </p>
		<p><i>For more analysis of NanoCore's actual code, see the reverse engineering conducted by <a href="https://0xm3h51n.medium.com/malware-analysis-nanocore-rat-6cae8c6df918">0xM3H51N</a> and <a href="https://mariohenkel.medium.com/decrypting-nanocore-config-and-dump-all-plugins-f4944bfaba52">Mario Henkel</a></i></p>
		<br>
		<h2>C2s In-The-Wild</h2>
		<p>it's here</p>
		<div class="ind">
			<div class="box">
				<h4>Distributed-DNS</h4>
				<p>This is my box w/ stuff.</p>
			</div>
		</div>
		<br>
		<h2>Defenses</h2>
		<p>block C2s</p>
		<p>suricata/snort</p>
		<br>
		<h4>See Also</h4>
		<div class="ind">
			<div class="box">
				<h4>Sources:</h4>
				<ul>
					<li><a href="https://www.fbi.gov/news/stories/malware-creator-sentenced-070518">www.fbi.gov/news/stories/malware-creator-sentenced-070518</a></li>
					<li><a href="https://any.run/malware-trends/nanocore">any.run/malware-trends/nanocore</a></li>
					<li><a href="https://attack.mitre.org/software/S0336/">attack.mitre.org/software/S0336/</a></li>
					<li><a href="https://0xm3h51n.medium.com/malware-analysis-nanocore-rat-6cae8c6df918">0xm3h51n.medium.com/malware-analysis-nanocore-rat-6cae8c6df918</a></li>
					<li><a href="https://mariohenkel.medium.com/decrypting-nanocore-config-and-dump-all-plugins-f4944bfaba52">mariohenkel.medium.com/decrypting-nanocore-config-and-dump-all-plugins-f4944bfaba52</a></li>
				</ul>
			</div>
		</div>
	</body>
</html>
